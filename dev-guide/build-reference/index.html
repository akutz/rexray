<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://github.com/emccode/rexray/dev-guide/build-reference/">
        <link rel="shortcut icon" href="../../favicon.png">
        

	<title>Build Reference - REX-Ray</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/emccode-font.css" rel="stylesheet">
        <link href="../../css/hX.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        

        <!-- scroll fix -->
        <script>
            //var shiftWindow = function() { scrollBy(0, -40) };
            //if (location.hash) shiftWindow();
            //window.addEventListener("hashchange", shiftWindow);
        </script>

    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">
                <i class="fa icon-rexray-logo"></i>
                REX-Ray
            </a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../user-guide/installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/config/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/storage-providers/">Storage Providers</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/schedulers/">Schedulers</a>
                        </li>
                    
                        <li >
                            <a href="../../user-guide/applications/">Applications</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">User Guide <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../../user-guide/installation/">Installation</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/config/">Configuration</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/storage-providers/">Storage Providers</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/schedulers/">Schedulers</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../user-guide/applications/">Applications</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Developers Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../project-guidelines/">Project Guidelines</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Build Reference</a>
                        </li>
                    
                        <li >
                            <a href="../release-process/">Release Process</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">Developers Guide <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../project-guidelines/">Project Guidelines</a>
                        </li>
                    
                    
                    
                        <li class="active">
                            <a href="./">Build Reference</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../release-process/">Release Process</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../about/contributing/">Contributing</a>
                        </li>
                    
                        <li >
                            <a href="../../about/license/">License</a>
                        </li>
                    
                        <li >
                            <a href="../../about/release-notes/">Release Notes</a>
                        </li>
                    
                    </ul>
                </li>
                <!--
                smart menus
                <li><a href="#">About <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                    
                    
                        <li >
                            <a href="../../about/contributing/">Contributing</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../about/license/">License</a>
                        </li>
                    
                    
                    
                        <li >
                            <a href="../../about/release-notes/">Release Notes</a>
                        </li>
                    
                    
                    </ul>
                </li>
                -->
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../project-guidelines/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../release-process/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/emccode/rexray.git">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
                <li>
                    <a href="https://emccode.github.io">
                        <i class="fa icon-emccode-logo"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>
        <div class="container ">
            <div class="col-md-3"><div id="sidenav" class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#build-reference">Build Reference</a></li>
        
            <li><a href="#build-requirements">Build Requirements</a>
            
            </li>
        
            <li><a href="#cross-compilation">Cross-Compilation</a>
            
            </li>
        
            <li><a href="#build-binary">Build Binary</a>
            
                <ul class="nav nav-stacked">
                
                <li><a href="#build-dependencies">Build Dependencies</a><!--
                -->
                </li>
                
                <li><a href="#basic-build">Basic Build</a><!--
                -->
                </li>
                
                <li><a href="#binary-size">Binary Size</a><!--
                -->
                </li>
                
                <li><a href="#build-all">Build All</a><!--
                -->
                </li>
                
                </ul>
            
            </li>
        
            <li><a href="#build-packages">Build Packages</a>
            
                <ul class="nav nav-stacked">
                
                <li><a href="#build-tarballs">Build Tarballs</a><!--
                -->
                </li>
                
                <li><a href="#build-rpms">Build RPMs</a><!--
                -->
                </li>
                
                <li><a href="#build-debs">Build DEBs</a><!--
                -->
                </li>
                
                </ul>
            
            </li>
        
            <li><a href="#version-file">Version File</a>
            
            </li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="build-reference">Build Reference</h1>
<p>How to build REX-Ray</p>
<hr />
<h2 id="build-requirements">Build Requirements</h2>
<p>This project has very few build requirements, but there are still one or two
items of which to be aware. Also, please note that this are the requirements to
<em>build</em> REX-Ray, not run it.</p>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Operating System</td>
<td>Linux, OS X</td>
</tr>
<tr>
<td><a href="https://golang.org/">Go</a></td>
<td>&gt;=1.6</td>
</tr>
<tr>
<td><a href="https://www.gnu.org/software/make/">GNU Make</a></td>
<td>&gt;=3.80</td>
</tr>
</tbody>
</table>
<p>OS X ships with a very old version of GNU Make, and a package manager like
<a href="http://brew.sh/">Homebrew</a> can be used to install the required version.</p>
<h2 id="cross-compilation">Cross-Compilation</h2>
<p>This project's <a href="https://github.com/emccode/rexray/blob/master/Makefile"><code>Makefile</code></a>
is configured by default to build for a Linux x86_64 target, but
cross-compilation <em>is</em> supported. Therefore the build environment should be
configured to support cross-compilation. Please take a minute to read
this <a href="http://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5">blog post</a>
regarding cross-compilation with Go &gt;=1.5.</p>
<h2 id="build-binary">Build Binary</h2>
<p>Building from source is pretty simple as all steps, including fetching
dependencies (as well as fetching the tool that fetches dependencies), are
configured as part of the included <code>Makefile</code>.</p>
<h3 id="build-dependencies">Build Dependencies</h3>
<p>The <code>make deps</code> command should be executed prior to any other targets in order
to ensure the necessary dependencies are available.</p>
<pre><code class="sh">$ make deps
target: deps
  ...installing glide...SUCCESS!
  ...glide up...[WARN] Only resolving dependencies for the current OS/Arch
[INFO] Downloading dependencies. Please wait...
[INFO] Fetching updates for github.com/Sirupsen/logrus.
[INFO] Fetching updates for golang.org/x/net.
[INFO] Fetching updates for github.com/spf13/cobra.
[INFO] Fetching updates for github.com/akutz/gofig.
[INFO] Fetching updates for github.com/emccode/libstorage.
[INFO] Fetching updates for gopkg.in/yaml.v1.
[INFO] Fetching updates for gopkg.in/yaml.v2.
[INFO] Fetching updates for google.golang.org/api.
[INFO] Fetching updates for github.com/go-yaml/yaml.
[INFO] Fetching updates for github.com/akutz/gotil.
[INFO] Fetching updates for github.com/spf13/pflag.
[INFO] Fetching updates for github.com/akutz/golf.
[INFO] Fetching updates for github.com/akutz/goof.
[INFO] Setting version for github.com/akutz/golf to v0.1.1.
[INFO] Setting version for gopkg.in/yaml.v1 to b4a9f8c4b84c6c4256d669c649837f1441e4b050.
[INFO] Setting version for github.com/go-yaml/yaml to b4a9f8c4b84c6c4256d669c649837f1441e4b050.
[INFO] Setting version for github.com/spf13/cobra to 363816bb13ce1710460c2345017fd35593cbf5ed.
[INFO] Setting version for google.golang.org/api to fd081149e482b10c55262756934088ffe3197ea3.
[INFO] Setting version for github.com/akutz/goof to v0.1.0.
[INFO] Setting version for github.com/akutz/gofig to v0.1.4.
[INFO] Setting version for github.com/spf13/pflag to b084184666e02084b8ccb9b704bf0d79c466eb1d.
[INFO] Setting version for github.com/Sirupsen/logrus to feature/logrus-aware-types.
[INFO] Setting version for gopkg.in/yaml.v2 to b4a9f8c4b84c6c4256d669c649837f1441e4b050.
[INFO] Setting version for github.com/akutz/gotil to v0.1.0.
[INFO] Setting version for github.com/emccode/libstorage to v0.1.3.
[INFO] Resolving imports
[INFO] Fetching github.com/spf13/viper into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Setting version for github.com/spf13/viper to support/rexray.
[INFO] Fetching github.com/kardianos/osext into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Setting version for github.com/kardianos/osext to master.
[INFO] Fetching github.com/gorilla/context into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/gorilla/mux into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/gorilla/handlers into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/cpuguy83/go-md2man/md2man into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/inconshreveable/mousetrap into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/BurntSushi/toml into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/kr/pretty into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/magiconair/properties into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/mitchellh/mapstructure into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/spf13/cast into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/spf13/jwalterweatherman into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching gopkg.in/fsnotify.v1 into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/emccode/goisilon into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Setting version for github.com/emccode/goisilon to f9b53f0aaadb12a26b134830142fc537f492cb13.
[INFO] Fetching github.com/emccode/goscaleio into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Setting version for github.com/emccode/goscaleio to 53ea76f52205380ab52b9c1f4ad89321c286bb95.
[INFO] Fetching github.com/appropriate/go-virtualboxclient/vboxwebsrv into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Setting version for github.com/appropriate/go-virtualboxclient to e0978ab2ed407095400a69d5933958dd260058cd.
[INFO] Fetching github.com/russross/blackfriday into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/kr/text into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching golang.org/x/sys/unix into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/cesanta/ucl into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/cesanta/validate-json/schema into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/shurcooL/sanitized_anchor_name into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/asaskevich/govalidator into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Fetching github.com/jteeuwen/go-bindata into /Users/akutz/Projects/go/src/github.com/emccode/rexray/vendor
[INFO] Setting version for github.com/jteeuwen/go-bindata to feature/md5checksum.
[INFO] Downloading dependencies. Please wait...
[INFO] Setting references for remaining imports
[INFO] Versions did not change. Skipping glide.lock update.
[INFO] Project relies on 38 dependencies.
SUCCESS!
  ...go get...SUCCESS!
cd vendor/github.com/emccode/libstorage &amp;&amp; make api/api_generated.go &amp;&amp; cd -
echo generating api/api_generated.go
generating api/api_generated.go
/Users/akutz/Projects/go/src/github.com/emccode/rexray
cd vendor/github.com/emccode/libstorage &amp;&amp; make api/server/executors/executors_generated.go &amp;&amp; cd -
GOOS=darwin GOARCH=amd64 go install ./api/types
GOOS=darwin GOARCH=amd64 go install ./api/context
GOOS=darwin GOARCH=amd64 go install ./api/utils
GOOS=darwin GOARCH=amd64 go install ./api/registry
GOOS=darwin GOARCH=amd64 go install ./api/utils/config
GOOS=darwin GOARCH=amd64 go install ./imports/config
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/isilon
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/isilon/executor
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/scaleio
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/scaleio/executor
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/vbox
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/vbox/executor
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/vfs
GOOS=darwin GOARCH=amd64 go install ./drivers/storage/vfs/executor
GOOS=darwin GOARCH=amd64 go install ./imports/executors
GOOS=darwin GOARCH=amd64 go install ./cli/lsx
GOOS=darwin GOARCH=amd64 go install ./cli/lsx/lsx-darwin
/Users/akutz/Projects/go/bin/go-bindata -md5checksum -pkg executors -prefix api/server/executors/bin -o api/server/executors/executors_generated.go api/server/executors/bin/...
/Users/akutz/Projects/go/src/github.com/emccode/rexray
</code></pre>

<h3 id="basic-build">Basic Build</h3>
<p>The most basic build can be achieved by simply typing <code>make</code> from the project's
root directory. For what it's worth, executing <code>make</code> sans arguments is the
same as executing <code>make install</code> for this project's <code>Makefile</code>.</p>
<pre><code class="sh">$ make
SemVer: 0.4.0-rc4+10+dirty
RpmVer: 0.4.0+rc4+10+dirty
Branch: release/0.4.0-rc4
Commit: d2f0283c7fed29ad0a142a6a51624828893f5db5
Formed: Wed, 15 Jun 2016 16:53:44 CDT

target: fmt
  ...formatting rexray...SUCCESS!
target: install
  ...installing rexray Darwin-x86_64...SUCCESS!

The REX-Ray binary is 40MB and located at:

  /Users/akutz/Projects/go/bin/rexray
</code></pre>

<h3 id="binary-size">Binary Size</h3>
<p>Please note that the large size of the binary is due to the Isilon
storage adapter's dependency on the
<a href="https://github.com/vmware/govmomi">VMware VMOMI library for Go</a>. The types
definition source in that package compiles to a 45MB, uncompressed archive.
Efforts are being made to figure out an alternative to this dependency in order
to reduce the binary size, even if it means creating VMware SOAP messages from
scratch.</p>
<h3 id="build-all">Build All</h3>
<p>In order to build all versions of the binary type the following:</p>
<pre><code class="sh">$ make build-all
SemVer: 0.4.0-rc4+10
RpmVer: 0.4.0+rc4+10
Branch: release/0.4.0-rc4
Commit: d2f0283c7fed29ad0a142a6a51624828893f5db5
Formed: Wed, 15 Jun 2016 16:42:33 CDT

target: fmt
  ...formatting rexray...SUCCESS!
target: build
  ...building rexray Linux-x86_64...SUCCESS!

The REX-Ray binary is 40MB and located at:

  .build/bin/Linux-x86_64/rexray
</code></pre>

<h2 id="build-packages">Build Packages</h2>
<p>The <code>Makefile</code> also includes targets that assist in the creation of
distributable packages using the produced artifact.</p>
<h3 id="build-tarballs">Build Tarballs</h3>
<p>The <code>Makefile</code>'s <code>build</code> and <code>build-all</code> targets will not only build the binary
in place, but it will also compress the binary as a tarball so it's ready for
deployment. For example, after the <code>make build-all</code> above, this is the contents
of the directory <code>.build/deploy</code>:</p>
<pre><code class="sh">$ ls .build/deploy
latest/
Linux-x86_64/
</code></pre>

<p>Looking inside the directory <code>.build/deploy/Linux-x86_64</code> reveals:</p>
<pre><code class="sh">$ ls .build/deploy/Linux-x86_64/
rexray-Linux-x86_64-0.4.0-rc4+10.tar.gz
</code></pre>

<h3 id="build-rpms">Build RPMs</h3>
<p>The <code>Makefile</code>'s <code>rpm-all</code> target will package the binary as
architecture-specific RPMs when executed on a system that supports the RPM
development environment:</p>
<pre><code class="sh">$ make rpm-all
target: rpm
  ...building rpm x86_64...SUCCESS!

The REX-Ray RPM is 11MB and located at:

  .build/deploy/Linux-x86_64/rexray-0.4.0+rc4+10-1.x86_64.rpm
</code></pre>

<h3 id="build-debs">Build DEBs</h3>
<p>The <code>Makefile</code>'s <code>deb-all</code> target will package the binary as
architecture-specific DEBs when executed on a system that supports the Alien
RPM-to-DEB conversion tools:</p>
<pre><code class="sh">$ make deb-all
target: deb
  ...building deb x86_64...SUCCESS!

The REX-Ray DEB is 9MB and located at:

  .build/deploy/Linux-x86_64/rexray_0.4.0+rc4+10-1_amd64.deb
</code></pre>

<h2 id="version-file">Version File</h2>
<p>There is a file at the root of the project named <code>VERSION</code>. The file contains
a single line with the <em>target</em> version of the project in the file. The version
follows the format:</p>
<p><code>(?&lt;major&gt;\d+)\.(?&lt;minor&gt;\d+)\.(?&lt;patch&gt;\d+)(-rc\d+)?</code></p>
<p>For example, during active development of version <code>0.4.0</code> the file would
contain the version <code>0.4.0</code>. When it's time to create <code>0.4.0</code>'s first
release candidate the version in the file will be changed to <code>0.4.0-rc1</code>. And
when it's time to release <code>0.4.0</code> the version is changed back to <code>0.4.0</code>.</p>
<p>Please note that we've discussed making the actively developed version the
targeted version with a <code>-dev</code> suffix, but trying this resulted in confusion
for the RPM and DEB package managers when using <code>unstable</code> releases.</p>
<p>So what's the point of the file if it's basically duplicating the utility of a
tag? Well, the <code>VERSION</code> file in fact has two purposes:</p>
<ol>
<li>
<p>First and foremost updating the <code>VERSION</code> file with the same value as that
     of the tag used to create a release provides a single, contextual reason to
     push a commit and tag. Otherwise some random commit off of <code>master</code> would
     be tagged as a release candidate or release. Always using the commit that
     is related to updating the <code>VERSION</code> file is much cleaner.</p>
</li>
<li>
<p>The contents of the <code>VERSION</code> file are also used during the build process
     as a means of overriding the output of a <code>git describe</code>. This enables the
     semantic version injected into the produced binary to be created using
     the <em>targeted</em> version of the next release and not just the value of the
     last, tagged commit.</p>
</li>
</ol></div>
        </div>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <!--
        <script src="../../.themes/yeti/js/base.js"></script>
        <script src="../../.themes/yeti/js/bootstrap-3.0.3.min.js"></script>
        <script src="../../.themes/yeti/js/highlight.pack.js"></script>
        <script src="../../.themes/yeti/js/jquery-1.10.2.min.js"></script>
        -->
    </body>

</html>